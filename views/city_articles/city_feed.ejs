<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= cityName %> Guide | TaiwanMe</title>
    <link rel="icon" href="/image/logo.png" type="image/png">
    
    <link rel="stylesheet" href="/style.css">

    <style>
        .city-hero-banner {
            background-color: #333; 
            background-image: 
            <% if (citySlug === 'pingtung') { %>
                url('/image/search_by_city/pingtung_banner.png');
            <% } else if (citySlug === 'kaohsiung') { %>
                url('/image/search_by_city/kaohsiung_banner.png');
            <% } else if (citySlug === 'chiayi') { %>
                url('/image/search_by_city/chiayi_banner.png');
            <% } else if (citySlug === 'tainan') { %>
                url('/image/search_by_city/tainan_banner.png');
            <% } else if (citySlug === 'taitung') { %>
                url('/image/search_by_city/taitung_banner.png');
            <% } else if (citySlug === 'hualien') { %>
                url('/image/search_by_city/hualien_banner.png');
            <% } else if (citySlug === 'yunlin') { %>
                url('/image/search_by_city/yunlin_banner.png');
            <% } else if (citySlug === 'nantou') { %>
                url('/image/search_by_city/nantou_banner.png');
            <% } else if (citySlug === 'changhua') { %>
                url('/image/search_by_city/changhua_banner.png');
            <% } else if (citySlug === 'taichung') { %>
                url('/image/search_by_city/taichung_banner.png');
            <% } else if (citySlug === 'miaoli') { %>
                url('/image/search_by_city/miaoli_banner.png');
            <% } else if (citySlug === 'hsinchu') { %>
                url('/image/search_by_city/hsinchu_banner.png');
            <% } else if (citySlug === 'yilan') { %>
                url('/image/search_by_city/yilan_banner.png');
            <% } else if (citySlug === 'taoyuan') { %>
                url('/image/search_by_city/taoyuan_banner.png');
            <% } else if (citySlug === 'keelung') { %>
                url('/image/search_by_city/keelung_banner.png');
            <% } else if (citySlug === 'new_taipei') { %>
                url('/image/search_by_city/new_taipei_banner.png');
            <% } else if (citySlug === 'taipei') { %>
                url('/image/search_by_city/taipei_banner.png');
            <% } else if (citySlug === 'penghu') { %>
                url('/image/search_by_city/penghu_banner.png');
            <% } else if (citySlug === 'kinmen') { %>
                url('/image/search_by_city/kinmen_banner.png');
            <% } else if (citySlug === 'matsu') { %>
                url('/image/search_by_city/matsu_banner.png');
            <% } else if (citySlug === 'offshore_islands') { %>
                url('/image/search_by_city/liuqiu_banner.png');
            <% } else { %>
                url('/image/search_by_city/taipei_banner.png');
            <% } %>;
        }
    </style>
</head>
<body>
    
    <%- include('../partials/header') %> 
    
    <div class="city-hero-banner">
        <div class="city-hero-overlay">
            <h1 class="city-name-title"><%= cityName %></h1>
            <p style="margin: 10px 0 0; font-family: var(--font-eng); letter-spacing: 2px; font-weight: 700; color: #555;">
                THE HIDDEN GEMS
            </p>
        </div>
    </div>

    <div class="feed-grid">
        <% if (typeof cityData !== 'undefined' && cityData.length > 0) { %>
            <% cityData.forEach(function(article) { %>
                
                <% 
                    let targetCitySlug = citySlug;
                    if (citySlug === 'offshore_islands') {
                        if (article.id.startsWith('pt')) targetCitySlug = 'pingtung';
                        else if (article.id.startsWith('tt')) targetCitySlug = 'taitung';
                        else if (article.id.startsWith('yl')) targetCitySlug = 'yilan';
                        else if (article.id.startsWith('kl')) targetCitySlug = 'keelung';
                    }
                    
                    // 定義文章連結
                    const articleLink = "/search_by_city/" + targetCitySlug + "/" + article.id;
                %>

                <div class="feed-card">
                    
                    <div class="feed-img-box">
                        <a href="<%= articleLink %>" style="display:block; width:100%; height:100%;">
                            <img src="<%= article.heroImage %>" class="feed-img" alt="<%= article.title %>" onerror="this.src='https://placehold.co/600x400/eee/333?text=TaiwanMe'">
                        </a>
                    </div>
                    
                    <div class="feed-content">
                        <div class="feed-tags">
                            <% if (article.tags && article.tags.length > 0) { %>
                                <% article.tags.slice(0, 2).forEach(function(tag){ %> 
                                    <span style="background-color: #f0f0f0; color: #777; padding: 4px 12px; border-radius: 15px; font-size: 0.75rem; text-transform: uppercase;">
                                        <%= tag.startsWith('#') ? tag : '#' + tag %>
                                    </span> 
                                <% }); %>
                            <% } %>
                        </div>
                        
                        <a href="<%= articleLink %>" style="text-decoration:none; color:inherit;">
                            <h2 class="feed-title">[<%= article.type %>] <%= article.title %></h2>
                        </a>
                        
                        <p class="feed-intro"><%- article.intro %></p>
                        
                        <a href="<%= articleLink %>" class="feed-btn" style="text-decoration:none; display:inline-block;">Read Itinerary ➝</a>
                    </div>
                </div>
            <% }); %>
        <% } else { %>
            <div style="text-align: center; grid-column: 1 / -1; padding: 100px 20px;">
                <h3 style="color: #999; font-family: var(--font-eng); font-size: 2rem;">Coming Soon...</h3>
                <p style="color: #bbb;">We are currently exploring <%= cityName %> to bring you the best guides.</p>
            </div>
        <% } %>
    </div>

    <%- include('../partials/footer') %>

    <script src="/script.js"></script>
</body>
</html>